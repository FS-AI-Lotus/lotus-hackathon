# Prometheus Configuration for Coordinator Service
# 
# This configuration scrapes metrics from the Coordinator service.
# Designed to easily extend to microservices later.
#
# Note: Hostnames and ports will be injected by Terraform/CI/CD pipeline
# or can be set via environment variables.

global:
  scrape_interval: 15s      # Scrape targets every 15 seconds
  evaluation_interval: 15s  # Evaluate rules every 15 seconds
  external_labels:
    cluster: 'lotus-hackathon'
    team: 'team4'

# Alertmanager configuration (optional - can be configured separately)
# alerting:
#   alertmanagers:
#     - static_configs:
#         - targets:
#           # - 'alertmanager:9093'

# Load alert rules
rule_files:
  - 'alerts.yml'

# Scrape configurations
scrape_configs:
  # Coordinator Service
  - job_name: 'coordinator'
    scrape_interval: 15s
    scrape_timeout: 10s
    metrics_path: '/metrics'
    static_configs:
      - targets:
          # TODO: Replace with actual Coordinator hostname:port
          # This will be injected by Terraform/CI or set via env vars
          - '${COORDINATOR_HOST:-localhost:3000}'
        labels:
          service: 'coordinator'
          environment: '${ENVIRONMENT:-development}'
    
    # Optional: Relabeling for additional metadata
    relabel_configs:
      - source_labels: [__address__]
        target_label: __param_target
      - source_labels: [__param_target]
        target_label: instance
      - target_label: __address__
        replacement: '${COORDINATOR_HOST:-localhost:3000}'

  # Placeholder for future microservices
  # Uncomment and configure when microservices are ready
  # - job_name: 'microservices'
  #   scrape_interval: 15s
  #   scrape_timeout: 10s
  #   metrics_path: '/metrics'
  #   static_configs:
  #     - targets:
  #         - 'microservice1:3001'
  #         - 'microservice2:3002'
  #       labels:
  #         service: 'microservices'
  #         environment: '${ENVIRONMENT:-development}'

# Optional: Remote write configuration for long-term storage
# remote_write:
#   - url: 'https://prometheus-remote-write.example.com/api/v1/write'
#     queue_config:
#       max_samples_per_send: 1000
#       max_shards: 200
#       capacity: 2500

